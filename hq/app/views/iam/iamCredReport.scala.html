@import model.CredentialReportDisplay
@import logic.DateUtils
@(report: CredentialReportDisplay)

@main(List("IAM report")) { @* Header *@
    <div class="container">
        <div class="row">
            <h1 class="header center-on-small-only grey-text text-lighten-5">IAM Credentials Report</h1>
        </div>
    </div>

} { @* Main content *@
    <div class="container">
        <div class="row">
            <div class="card-panel">
                    <span>Report generated at @{DateUtils.printTime(report.reportDate)} (refreshed every four hours)</span>
            </div>
        </div>
        <div class="row">
            <div class="col s12">
                <table class="striped responsive-table iam-report__table" >
                    <tr>
                        <th>User name</th>
                        <th>Access Keys</th>
                        <th>Password/MFA</th>
                        <th>Last Activity</th>
                        <th>Status</th>
                    </tr>
                    @for(cred <- report.humanUsers) {
                        <tr>
                            <td><span>@views.html.fragments.username(cred.username)</span></td>
                            <td>@views.html.fragments.allKeyStatus(cred.key1Status, cred.key2Status)</td>
                            <td>@views.html.fragments.mfa(cred.hasMFA)</td>
                            <td>
                                <span>
                                    @views.html.fragments.lastActivityDay(cred.lastActivityDay)
                                </span>
                            </td>
                            <td>@views.html.fragments.humanReportStatus(cred.reportStatus)</td>
                        </tr>
                    }
                    @for(cred <- report.machineUsers) {
                        <tr>
                            <td>@views.html.fragments.username(cred.username)</td>
                            <td>@views.html.fragments.allKeyStatus(cred.key1Status, cred.key2Status)</td>
                            <td><span>-</span></td>
                            <td>
                                <span>@views.html.fragments.lastActivityDay(cred.lastActivityDay)</span>
                            </td>
                            <td>@views.html.fragments.machineReportStatus(cred.reportStatus)</td>
                        </tr>
                    }
                </table>
            </div>
        </div>
    </div>

}
