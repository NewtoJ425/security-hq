@import model._
@(reports: Map[AwsAccount, Either[utils.attempt.FailedAttempt, CredentialReportDisplay]])


@main(List("IAM report")) { @* Header *@
    <div class="container">
        <div class="row">
            <h1 class="header center-on-small-only grey-text text-lighten-5">IAM Report</h1>
            <div class="col s12 m9">
                <h4 class="grey-text text-darken-4 center-on-small-only">For all accounts</h4>
            </div>
        </div>
    </div>

} { @* Main content *@
    <div class="container">
        <ul class="collapsible" data-collapsible="accordion">
        @for((account, report) <- reports) {
            <li>
                <div class="collapsible-header">
                    @account.name
                    @report match {
                        case Left(fa) => {
                            <p class="p--warning">
                            @for(err <- fa.failures) {
                                @err.friendlyMessage
                            }
                            </p>
                        }
                        case Right(re) => {
                            @views.html.fragments.statusSummary(re)
                        }
                    }
                </div>
                <div class="collapsible-body">
                @report match {
                    case Right(re) => {
                        @views.html.iam.iamCredReportBody(re)
                    }
                    case _ => {}
                }
                </div>
            </li>
        }
        </ul>
    </div>
}
